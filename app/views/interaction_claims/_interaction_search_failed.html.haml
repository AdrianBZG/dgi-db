- ambiguous_matches = ambiguous_results + ambiguous_no_interactions
%div{style: "float: right; margin-top: -15px; width: 17%"}
  = render partial: 'shared/page_export'
  %div.well{style: "margin-top: 15px;"}
    %h3{style: "margin-top: -5px;"}
      Unmatched Terms
    - failed_terms.each do |term|
      %li
        = term

  %div.well{style: "margin-top: -5px;"}
    %h3{style: "margin-top: -5px; margin-bottom: -5px;"}
      Multiple Matches
    %div{style: "width: 200px; padding: 0", class: "container demo"}
      %div(class="panel-group" id="accordion" role="tablist" aria-multiselectable="true")
      - ambiguous_matches.each do |result|
        %div{class: "panel-heading", role: "tab", id: "#{'heading' + result[:term]}"}
          %h4(class="panel-title" style="margin-left: -20px;")
            %a{role: "button", "data-toggle" => "collapse", "data-parent" => "#accordion", href: "#{'#collapse' + result[:term]}", "aria-expanded" => "true", "aria-controls" => "#{'collapse' + result[:term]}", style: "word-wrap: break-word; display: inline-block;"}
              %i(class="more-less glyphicon glyphicon-plus")
              = "Search Term: " + result[:term]

        %div{id: "#{'collapse' + result[:term]}", class: "panel-collapse collapse", role: "tabpanel", "aria-labelledby" => "#{'heading' + result[:term]}"}
          %div{class: "panel-body tree", style: "padding: 0px;"}
          - result[:identifiers].each do |entity|
            %div{class: "tree_label"}
              %input{class: "ambiguous sidebar-toggle", type: "checkbox", name: "#{entity.name + "-ambiguous"}", checked: 1}
                = entity.name

%div{style: "float: left; width: 81%;"}
  %ul(class="result-list" id="list-results")
    - ambiguous_matches.each do |result|
      - result[:identifiers].each do |entity|
        %li{class: "interaction interaction-panel", "data-category" => "interaction", "data-name" => "Interaction", id: entity.name + "-ambiguous", style: "display: list-item; width: 100%;"}
          = render partial: 'interaction_claims/interactions_search_panel', locals: { term: result[:term], entity: entity, filtered_interactions: result[:interactions] }

:css
  /* ————————————————————–
    Tree core styles
  */
  .tree { margin: 1em; }

  .tree input {
    position: absolute;
    clip: rect(0, 0, 0, 0);
    }

  .tree input ~ ul { display: none; }

  .tree input:checked ~ ul { display: block; }

  /* ————————————————————–
    Tree rows
  */
  .tree li {
    line-height: 1.2;
    position: relative;
    padding: 0 0 1em 1em;
    }

  .tree ul li { padding: 1em 0 0 1em; }

  .tree > li:last-child { padding-bottom: 0; }

  /* ————————————————————–
    Tree labels
  */
  .tree_label {
    position: relative;
    display: inline-block;
    background: #fff;
    }

  label.tree_label { cursor: pointer; }

  label.tree_label:hover { color: #666; }

  /* ————————————————————–
    Tree expanded icon
  */
  label.tree_label:before {
    background: #000;
    color: #fff;
    position: relative;
    z-index: 1;
    float: left;
    margin: 0 1em 0 -2em;
    width: 1em;
    height: 1em;
    border-radius: 1em;
    content: '+';
    text-align: center;
    line-height: .9em;
    }

  :checked ~ label.tree_label:before { content: '–'; }

  /* ————————————————————–
    Tree branches
  */
  .tree li:before {
    position: absolute;
    top: 0;
    bottom: 0;
    left: -.5em;
    display: block;
    width: 0;
    border-left: 1px solid #777;
    content: "";
    }

  .tree_label:after {
    position: absolute;
    top: 0;
    left: -1.5em;
    display: block;
    height: 0.5em;
    width: 1em;
    border-bottom: 1px solid #777;
    border-left: 1px solid #777;
    border-radius: 0 0 0 .3em;
    content: '';
    }

  label.tree_label:after { border-bottom: 0; }

  :checked ~ label.tree_label:after {
    border-radius: 0 .3em 0 0;
    border-top: 1px solid #777;
    border-right: 1px solid #777;
    border-bottom: 0;
    border-left: 0;
    bottom: 0;
    top: 0.5em;
    height: auto;
    }

  .tree li:last-child:before {
    height: 1em;
    bottom: auto;
    }

  .tree > li:last-child:before { display: none; }

  .tree_custom {
    display: block;
    background: #eee;
    padding: 1em;
    border-radius: 0.3em;
  }

:javascript
  function toggleIcon(e) {
    $(e.target)
      .prev('.panel-heading')
      .find(".more-less")
      .toggleClass('glyphicon-plus glyphicon-minus');
  }
  $('.panel-group').on('hidden.bs.collapse', toggleIcon);
  $('.panel-group').on('shown.bs.collapse', toggleIcon);
